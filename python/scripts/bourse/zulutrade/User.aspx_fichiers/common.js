$j(document).ready(function(){if(!window.Node){window.Node=new Object();Node.ELEMENT_NODE=1;Node.ATTRIBUTE_NODE=2;Node.TEXT_NODE=3;Node.CDATA_SECTION_NODE=4;Node.ENTITY_REFERENCE_NODE=5;Node.ENTITY_NODE=6;Node.PROCESSING_INSTRUCTION_NODE=7;Node.COMMENT_NODE=8;Node.DOCUMENT_NODE=9;Node.DOCUMENT_TYPE_NODE=10;Node.DOCUMENT_FRAGMENT_NODE=11;Node.NOTATION_NODE=12}$j("table.tabs_main td a").mouseover(function(){var a=$j(this).parent();if(a.hasClass("first")){a.addClass("first-active")}else{if(a.hasClass("last")){a.addClass("last-active")}else{a.addClass("active")}}}).mouseout(function(){$j("table.tabs_main td").removeClass("active first-active last-active")})});function goToLocation(a){if(parent){parent.location=a}else{window.location=a}}function toggleTableColumnVisibility(c,a,b){$j("table#"+c+" tr").each(function(){$j("th:eq("+a+"), td:eq("+a+")",this).toggle(b)})}var async_hidden_field="";var async_event_argument_value="";function loadContent(b,d,c){if(d){if(c){var a=$j("#"+d+" div:first");if(a.length==0){return}a=a.attr("id").replace(/_/g,"$");$j("#"+async_hidden_field).val(a+"|"+c+"|true");__doPostBack(a,async_event_argument_value)}else{hideLoadingProgress();showContainer(d)}}showTab(b);if(d==null&&$j("#content-"+b)){showContainer("content-"+b)}}var last_timer_postback_id="";function beforeAsyncLoadContent(d,c){var e=c.get_postBackElement().id;var a=Sys.WebForms.PageRequestManager.getInstance();if(e.indexOf("LinkButtonRefresh")>=0){if(a.get_isInAsyncPostBack()){if(last_timer_postback_id==e){c.set_cancel(true);return}else{a.abortPostBack()}}last_timer_postback_id=e;return}var b=$j("#"+e).closest("div.content_box_inner2");if(b.length==0){return}if(a.get_isInAsyncPostBack()){if(async_loading_container&&async_loading_container.attr("id")==b.attr("id")){c.set_cancel(true);return}else{a.abortPostBack();hideLoadingProgress()}}showLoadingProgress(b)}var show_async_errors=false,last_error_message=false,window_unloading=false;function showAsyncExceptions(b,a){if(a.get_error()==undefined||window_unloading){if(last_error_message){last_error_message.zmessage("timeout",5);last_error_message=false}return}var d=a.get_error();var c=d.httpStatusCode==0?translations.JSCheckInternetConnection:translations.JSSorry;if(show_async_errors){c+="<br /><strong>Response Status:</strong> "+a.get_response().get_statusCode()+" ("+d.httpStatusCode+")";c+="<br /><strong>Exception:</strong> "+d.message}if(!last_error_message||d.message!=last_error_message.data("message")){if(last_error_message){last_error_message.zmessage("timeout",5)}last_error_message=$j.zmessage({message:c,className:"zmessage-error",timeout:0});last_error_message.data("message",d.message)}hideLoadingProgress();a.set_errorHandled(true)}$j(window).bind("beforeunload",function(){window_unloading=true});function afterAsyncLoadContent(b,a){if(async_loading_container){showContainer(async_loading_container.attr("id"))}hideLoadingProgress()}function showLoadingProgress(a){if(a&&a.length>0){async_loading_container=a}if(a&&a.length>0&&a.children("div.container-loading-overlay").length==0){var b=$j('<div class="container-loading-overlay"></div>').css({opacity:0.5}).dimensions(a.dimensions()).fadeIn(500);a.append(b)}if(!async_loading_message){async_loading_message=$j.zmessage({message:translations.JSPageLoading,className:"zmessage-progress",timeout:0,disableClose:true})}if(async_loading_timeout){clearTimeout(async_loading_timeout)}async_loading_timeout=setTimeout(function(){$j.zmessage({message:translations.JSCheckInternetConnection,className:"zmessage-error"});hideLoadingProgress()},60000)}function hideLoadingProgress(){if(async_loading_message){async_loading_message.zmessage("close");async_loading_message=false}if(async_loading_container){async_loading_container.children("div.container-loading-overlay").fadeOut(500).remove();async_loading_container=false}if(async_loading_timeout){clearTimeout(async_loading_timeout);async_loading_timeout=false}}var async_loading_container=false;var async_loading_message=false;var async_loading_timeout=false;function showTab(c){if(!c){return false}var b=$j("ul.user-tabs li a.active");if(b.length==0||(b.length>0&&b.attr("href")!="#"+c)){b.removeClass("active");b=$j("ul.user-tabs li a[href='#"+c+"']").addClass("active");$j("ul.user-subtabs").hide();if(b.length>0){var a=$j("#subtab-"+c);if(a.length>0){a.fadeIn(300)}}}}var active_container_id="";function showContainer(b){$j("div.content_box_inner2").hide();var a=$j("#"+b);if(a.length==0){$j.zmessage({message:translations.JSPageNotExistS1+'<strong>(#" + container_id + ")</strong>'+translations.JSPageNotExistS2+'<a href="User.aspx">'+translations.JSPageNotExistS3+"</a>"+translations.JSPageNotExistS1,className:"zmessage-error"})}else{a.show();active_container_id=b}if(typeof(timer_positions)!=="undefined"){timer_positions.toggle(b=="content-open-positions"||b=="content-pending-orders")}if(typeof(timer_open_trade)!=="undefined"){timer_open_trade.toggle(b=="content-open-trade")}}function backtestProviders(d){var b=$j("input[name=RadioButtonSelectedProvider]:checkbox"),g=b.filter(":checked"),c=(g.length>0?g:b).map(function(){return $j(this).val()}).get().join(","),f=$j("input[name=backtest-currencies]:checked").map(function(){return $j(this).val()}).get().join(","),a=$j("#backtest-slippage").val();DisplayChart("backtest-graph","WebServices/Charts.ashx?culture="+d.data.culture+"&g=bt&b="+d.data.b+"&p="+c+"&c="+f+"&slp="+a);$j("#backtest-modal").dialog("open")}function updateSafestStop(){var a=$j(this).val();var c=(a=="0"||a=="")&&a!="*";var b=$j(this).parent().next().find("input:checkbox");if(b.attr("checked")&&c){b.attr("checked","");b.closest("td").find("input:hidden").val("0")}b.attr("disabled",c)}function toMoney(d,c,b){if(!b){return(d<0?"-":"")+c+Math.abs(d)}else{nStr=Math.abs(d).toFixed(2)+"";x=nStr.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var a=/(\d+)(\d{3})/;while(a.test(x1)){x1=x1.replace(a,"$1,$2")}return(d<0?"-":"")+c+x1+x2}}function showTradeDetails(c,b){var a=$j("<iframe/>").attr("id","trade-details-iframe").attr("width","100%").attr("height","100%").attr("marginheight","0").attr("frameborder","0").attr("scrolling","auto").attr("src","TradeDetails.aspx?pt="+c+"&ot="+(b?"1":"0"));$j("#trade-details").html(a);$j("#trade-details").dialog("open");return false}function showUpdateTrade(d,a,c,b){$j("#trade-signal-ticket").val(d);$j("#trade-update-type").val(a);$j("#trade-new-value").val(c);$j("#trade-old-value").val(c);$j("#dialog-update-trade").dialog("option","title",b);$j("#dialog-update-trade").dialog("open")}function submitUpdateTrade(){$j("#dialog-update-trade").dialog("close");var a=$j("#trade-signal-ticket").val();var c=$j("#trade-update-type").val();var b=$j("#trade-new-value").val();PageMethods.UpdateTradeClient(a,c,b,showResponseMessages,webMethod_Error)}function AJAXUpdateTradeCache(){$j("#button-reload-positions, #button-reload-orders").hide();setTimeout(function(){$j("#button-reload-positions, #button-reload-orders").show()},30000);PageMethods.UpdateTradesCache(showResponseMessages,webMethod_Error);PageMethods.GetUserTrades(onSuccessGetUserTrades)}function AJAXCloseOrphanTrade(d,c,b){d=$j(d).hide();var a=$j('<img src="Images2/progress.gif" alt="'+translations.JSPleaseWait+'" />');d.parent().append(a);if(!confirm(b+"\n"+translations.JSCloseTrade)){d.show();a.remove();return}PageMethods.CloseOrphanTrade(c,b,closeTrade_Success,closeTrade_Error,[d])}function AJAXCloseTrade(f,l,g,j,c,b){var h="";if(c>0&&!b){var k=new Date();var e=k.getTime()+(k.getTimezoneOffset()*60000);var d=(new Date(j)).getTime();var i=(e-d)/1000;if(i<60){h=[g," ",translations.JSScalpingAlertS1," ",i," ",translations.JSScalpingAlertS2].join("")}}if(h==""){h=g+"\n"+translations.JSCloseTrade}f=$j(f).hide();var a=$j('<img src="Images2/progress.gif" alt="'+translations.JSPleaseWait+'" />');f.parent().append(a);if(!confirm(h)){f.show();a.remove();return}PageMethods.CloseTrade(l,g,closeTrade_Success,closeTrade_Error,[f])}function closeTrade_Success(a,c,b){showResponseMessage(a);$j(c[0]).show().parent().children("img").remove()}function closeTrade_Error(a,c,b){webMethod_Error(a,c,b);$j(c[0]).show().parent().children("img").remove()}function AJAXCloseAllTrades(a){if(!confirm(translations.JSClosePositions+" "+(a?translations.JSPendingOrders:translations.JSOpenPositions))){return}PageMethods.CloseAllTrades(a,showResponseMessages,webMethod_Error)}function showResponseMessages(d,c,b){if(typeof(d)==="object"&&d.Text){showResponseMessage(d);return}for(var a=0;a<d.length;a++){if(d[a].Delay==0){d[a].Delay=a*700}showResponseMessage(d[a],c,b)}}function showResponseMessage(d,b,a){if(typeof(d)!=="object"||!d.Text){return}var c;switch(d.Level){case 0:c="zmessage-error";break;case 1:c="zmessage-warning";break;case 2:c="zmessage-success";break;case 4:c="zmessage-debug";break;default:c="zmessage-info"}var e=function(){$j.zmessage({message:d.Text,className:c,timeout:d.Timeout,disableClose:d.DisableClose})};if(d.Delay>0){setTimeout(e,d.Delay)}else{e()}}function webMethod_Error(a,c,b){if(a.get_statusCode()==0){$j.zmessage({message:translations.JSCheckInternetConnection,className:"zmessage-error"})}else{$j.zmessage({message:translations.JSSorry,className:"zmessage-error"})}}function getCalendarEvents(){PageMethods.GetCalendarEventsForRates(function(b){var c=$j("ul.rates li .name .rate-calendar-event").hide().data("calendar_remaining_seconds",10000).data("calendar_tooltip","").each(function(){if(typeof $j(this).data("qtip")==="object"){$j(this).qtip("api").updateContent("");return true}$j(this).qtip($j.extend(true,{},qtip_zulutrade_tooltip,{show:{solo:true,ready:false},style:{width:{min:460,max:600}},content:{text:"test",title:calendar_i18n.UpcomingEconomicReleases,prerender:true}}))});c.closest(".currency-box").removeClass("highlight-calendar");if(!b){return}$j.each(b,function(f,d){c.filter(function(){return $j(this).parent().find(".pair").text().indexOf(d.c)>-1}).each(function(){var e=$j(this);e.data("calendar_remaining_seconds",Math.min(e.data("calendar_remaining_seconds"),d.r)).data("calendar_tooltip",e.data("calendar_tooltip")+a(d))}).addClass("visible-marker").show()});c.filter(".visible-marker").each(function(){var d=$j(this);d.qtip("api").updateContent(d.data("calendar_tooltip")+calendar_i18n.PatentPending,true)})});function a(c){var b,d;switch(c.i){case 0:b="thi_economic_event_non.png";d=calendar_i18n.NonEconomic;break;case 1:b="thi_economic_event_low.png";d=calendar_i18n.LowImpact;break;case 2:b="thi_economic_event_medium.png";d=calendar_i18n.MediumImpact;break;case 3:b="thi_economic_event_high.png";d=calendar_i18n.HighImpact;break}return'<div style="float: left; height: 37px; margin-right: 10px; text-align: center;"><img src="Images/'+b+'" style="margin-bottom: 5px;" /><br />'+d+"</div><strong>"+c.t+"</strong> on "+c.d+"<br />"+calendar_i18n.Currency+": "+c.c+"<br />"+calendar_i18n.Previous+": "+c.p+", "+calendar_i18n.Forecast+": "+c.f+"<hr />"}}function updateEventRemainingTime(){$j("ul.rates li .name .rate-calendar-event").filter(".visible-marker").each(function(){var c=$j(this),b=c.data("calendar_remaining_seconds")-1;if(b<=0){c.hide();return true}c.data("calendar_remaining_seconds",b).text(a(b)).closest(".currency-box").toggleClass("highlight-calendar",b<=5)});function a(c){var b=parseInt(c/60),c=parseInt(c%60);return(b<10?"0"+b:b)+":"+(c<10?"0"+c:c)}}(function(a){function b(e,c,d,f,g){if(e==c){return f}if(e<=this.options.selectedList){return a(d).map(function(h,i){return i.title}).get().join(", ")}return String.format(g,e)}a.extend(a.ech.multiselect.prototype,{getCheckedValues:function(){return a.map(this.getChecked(),function(d,c){return d.value})},updateOptions:function(){var c=this.getCheckedValues();this.element.children("option").removeAttr("selected").filter(function(){return a.inArray(this.value,c)>-1}).attr("selected","selected");return c}});a.fn.thProviderMultiSelect=function(c){return this.each(function(){function e(g){if(a.isArray(g)){var h=3,f=g;g=false;if(f.length>0&&f[0]==c.accProfit){g=true}else{a.each(f,function(i,j){return(g=i<=h-1&&j>=0)})}}a(c.cbMonthly).attr("disabled",!g);return g}a(this).multiselect({checkAllText:c.CheckAll,uncheckAllText:c.UncheckAll,noneSelectedText:c.SelectSignalProviders,selectedList:1,selectedText:function(h,f,g){return b.apply(this,[h,f-2,g,c.AllProvidersSelected,c.ProvidersSelected])},classes:"no-qtip",click:function(g,h){a(this).multiselect("getChecked").each(function(j,k){var i=a(k);if(h.value<0){i.attr("checked",i.val()==h.value)}else{if(parseInt(i.val())<0){i.attr("checked",false)}}});var f=a(this).multiselect("updateOptions");e(f)},checkAll:function(g,h){a(this).multiselect("getChecked").each(function(j,k){var i=a(k);i.attr("checked",parseInt(i.val())>=0)});var f=a(this).multiselect("updateOptions");e(f);a(this).multiselect("update")},uncheckAll:function(g,h){a(this).multiselect("widget").find("input:eq(0)").attr("checked",true);var f=a(this).multiselect("updateOptions");e(f);a(this).multiselect("update")}}).next("button").css({width:200,height:25,overflow:"hidden"});a(this).multiselect("widget").find("input:checkbox").addClass("no-qtip").each(function(f,g){if(parseInt(g.value)<0){a(g).next("span").addClass("bold")}});var d=a(this).multiselect("getCheckedValues");e(d)})};a.fn.thCurrencyMultiSelect=function(c){return this.each(function(){a(this).multiselect({checkAllText:c.CheckAll,uncheckAllText:c.UncheckAll,noneSelectedText:c.SelectCurrencyPairs,selectedList:2,selectedText:function(f,d,e){return b.apply(this,[f,d,e,c.AllCurrenciesSelected,c.CurrenciesSelected])},classes:"no-qtip"}).next("button").css({width:190,height:25,overflow:"hidden"});a(this).multiselect("widget").find("input:checkbox").addClass("no-qtip")})}})(jQuery);function thRenderGraph(k){var e=$j(k.lbProviders).multiselect("getCheckedValues"),j=$j(k.lbCurrencies).multiselect("getCheckedValues"),f=$j(k.tbDateFrom).datepicker("getDate"),h=$j(k.tbDateTo).datepicker("getDate"),b="currency",i="pips",d=$j(k.rblValueType+":checked").val()||i,c=$j(k.cbMonthly).is(":checked:enabled"),a;if(j.length==0||f==null||h==null){return}if(k.providerId>0&&c){e=[k.providerId];a="phm"}else{if(k.providerId>0){e=[k.providerId];a="ph"}else{if(e.length==0){return}else{if(e[0]==k.accProfit&&c){e=[];a="hsm"}else{if(e[0]==k.accProfit){e=[-1];a="hs"}else{if(e[0]==k.accProfitEachProvider){e=[];a=d==i?"tpp":"hma"}else{if(e.length==1&&e[0]!=k.manualTradesValue&&d==i){a=c?"tpm":"tp"}else{a=c?"hmm":"hm"}}}}}}}if(d==b){d=k.userCurrency}var g=$j(k.lbProviders+" option").map(function(){return parseInt(this.value)}).filter(function(){return this>=0}).get();if($j.compare(e,g)){e=[]}if(j.length==$j(k.lbCurrencies+" option").length){j=[]}DisplayChart("history-graph","WebServices/Charts.ashx?culture="+k.cultureName+"&g="+a+"&b="+k.traderId+"&p="+e.join(",")+"&c="+j.join(",")+"&f="+d+"&df="+$j.datepicker.formatDate($j.datepicker.ISO_8601,f)+"&dt="+$j.datepicker.formatDate($j.datepicker.ISO_8601,h))}var Timer=function(){this.interval=1000;this.enable=false;this.tick=false;var b=0;var a;this.start=function(){if(this.enable||!this.tick){return}this.enable=true;a=this;a.timer_id=setInterval(function(){if(a.tick){a.tick()}},this.interval);if(this.interval>=1000&&this.tick){this.tick()}};this.stop=function(){if(!this.enable){return}this.enable=false;clearInterval(a.timer_id)};this.toggle=function(c){if(c){this.start()}else{this.stop()}};this.updateInterval=function(c){this.interval=c;if(this.enable){this.stop();this.start()}}};function ClientPopulated(d,g){var a=d.get_completionList().childNodes;for(var c=0;c<a.length;c++){if(a[c]._value!=null||a[c]._value!="undefined"){var f=a[c]._value.split(",");var h=f[0];var b=f[1];a[c].innerHTML="<table><tr><td><img style='height:25px;width:25px'  alt='"+b+"' src='Image.ashx?type=provider&size=S&id="+h+"' /></td><td>"+b+"</td></table>"}}}function ClientItemSelected(a,b){if(b.get_value()!=null||b.get_value()!="undefined"){var c=b.get_text();if(c==null){c=b.get_item().alt}if(c==null){c=b.get_value().split(",")[1]}a.get_element().value=c}}function isValidLotsValue(g,i,e,c,f){if(g==f){return true}var b=parseFloat(g);if(b==0){return true}var a=(b*10000);var d=parseInt(a);var h=parseFloat(d);if(!isNaN(b)&&b>=i&&b<=e&&(h%(c*10000))==0){return true}return false}function validateLotsOnKeyUp(b,a,d,c){b.style.color=isValidNumericValue(b.value,a,d,c)?"":"Red"}function validateLotsOnFocus(b,a,d,c){if(!isValidNumericValue(b.value,a,d,c)){b.value=""}}function validateLotsOnBlur(b,a,e,d){if(!isValidNumericValue(b.value,a,e,d)){b.style.color="Red";alert("The value you have entered is not valid.\nPlease correct the value with a number that is between "+a+" and "+e+", and is multiple of "+d+".");b.value=a;b.style.color="";$j(b).focus()}else{var c=b.value=="*"?"*":0;b.value=isNaN(b.value)?c:parseFloat(b.value);b.style.color=""}}function chbNoLimitChanged(c,b,a){b.val(c?"*":a);b.attr("disabled",c?"disabled":"")}function numericOnly(b){var a;if(window.event){a=window.event.keyCode;if(((a>47)&&(a<58))||(a==46)||(a==0)||(a==8)){b.returnValue=true}else{b.returnValue=false}}else{a=b.which;return(((a>47)&&(a<58))||(a==46)||(a==0)||(a==8))}}var tagHistory="";function selectTag(a,b){if(tagHistory!=b){$j("#"+a).closest("table").find("tbody > tr:gt(0)").each(function(){$j(this).children("td,th").removeClass("highlight-tags")})}$j("#"+a).closest("table").find("tbody > tr:gt(0)").each(function(c,d){if(tagHistory!=b){$j(d).children("td,th").removeClass("highlight-tags")}$j(this).find("td:eq(1) ul.tags li a.tag").each(function(){if($j(this).text().indexOf(b)!=-1){$j(d).children("td,th").toggleClass("highlight-tags");tagHistory=b}})})}function deleteTag(a,c){ZuluTrade.WebServices.Tags.RemoveTag(c);var b=$j("#"+a).closest("li").closest("ul");$j("#"+a).closest("li").slideUp("normal",function(){$j(this).remove();if(b.children().length<=2){b.hide()}})}var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,c=function(f,e){f=String(f);e=e||2;while(f.length<e){f="0"+f}return f};return function(i,v,q){var g=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){v=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i)){throw SyntaxError("invalid date")}v=String(g.masks[v]||v||g.masks["default"]);if(v.slice(0,4)=="UTC:"){v=v.slice(4);q=true}var t=q?"getUTC":"get",l=i[t+"Date"](),e=i[t+"Day"](),j=i[t+"Month"](),p=i[t+"FullYear"](),r=i[t+"Hours"](),k=i[t+"Minutes"](),u=i[t+"Seconds"](),n=i[t+"Milliseconds"](),f=q?0:i.getTimezoneOffset(),h={d:l,dd:c(l),ddd:g.i18n.dayNames[e],dddd:g.i18n.dayNames[e+7],m:j+1,mm:c(j+1),mmm:g.i18n.monthNames[j],mmmm:g.i18n.monthNames[j+12],yy:String(p).slice(2),yyyy:p,h:r%12||12,hh:c(r%12||12),H:r,HH:c(r),M:k,MM:c(k),s:u,ss:c(u),l:c(n,3),L:c(n>99?Math.round(n/10):n),t:r<12?"a":"p",tt:r<12?"am":"pm",T:r<12?"A":"P",TT:r<12?"AM":"PM",Z:q?"UTC":(String(i).match(b)||[""]).pop().replace(d,""),o:(f>0?"-":"+")+c(Math.floor(Math.abs(f)/60)*100+Math.abs(f)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return v.replace(a,function(m){return m in h?h[m]:m.slice(1,m.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(a,b){return dateFormat(this,a,b)};